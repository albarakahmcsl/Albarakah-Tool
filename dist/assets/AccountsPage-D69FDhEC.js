import{c as D,e as Q,r as d,j as e,W as U,m as B,t as I,C as W,w as b,i as N,q as x,n as X,v as R}from"./index-kpoZTUVu.js";import{u as w}from"./useQuery-CVr4asLY.js";import{u as _,P as G,S as H,T as J}from"./trash-2-ChqBLc-W.js";import{D as V}from"./dollar-sign-BGUed5ZK.js";import{S as Y}from"./square-pen-CQXykoed.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=D("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=D("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function ce(){const l=Q(),[c,m]=d.useState(""),[h,i]=d.useState(!1),[r,n]=d.useState(!1),[o,s]=d.useState(null),[a,f]=d.useState(null),[C,g]=d.useState(null),{data:y,isLoading:L}=w({queryKey:x.accounts(),queryFn:b.getAccounts}),{data:j}=w({queryKey:x.members(),queryFn:X.getMembers}),{data:v}=w({queryKey:x.accountTypes(),queryFn:R.getAccountTypes}),k=_({mutationFn:b.createAccount,onSuccess:()=>{g("Account created successfully"),i(!1),l.invalidateQueries({queryKey:x.accounts()})},onError:t=>{f(t instanceof N?t.message:"Failed to create account")}}),A=_({mutationFn:({accountId:t,accountData:u})=>b.updateAccount(t,u),onSuccess:()=>{g("Account updated successfully"),n(!1),s(null),l.invalidateQueries({queryKey:x.accounts()})},onError:t=>{f(t instanceof N?t.message:"Failed to update account")}}),S=_({mutationFn:b.deleteAccount,onSuccess:()=>{g("Account deleted successfully"),l.invalidateQueries({queryKey:x.accounts()})},onError:t=>{f(t instanceof N?t.message:"Failed to delete account")}}),E=t=>{k.mutate(t)},P=t=>{o&&A.mutate({accountId:o.id,accountData:t})},T=t=>{confirm("Are you sure you want to delete this account? This action cannot be undone.")&&S.mutate(t)},K=(y==null?void 0:y.accounts)||[],q=(j==null?void 0:j.members)||[],M=(v==null?void 0:v.account_types)||[],F=loaderData.bankAccounts||[],O=L||k.isPending||A.isPending||S.isPending,z=K.filter(t=>{var u,p;return t.account_number.toLowerCase().includes(c.toLowerCase())||((u=t.members)==null?void 0:u.full_name)&&t.members.full_name.toLowerCase().includes(c.toLowerCase())||((p=t.account_types)==null?void 0:p.name)&&t.account_types.name.toLowerCase().includes(c.toLowerCase())});return e.jsxs("div",{className:"space-y-6 pt-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Account Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage individual member accounts and their details."})]}),e.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Account"]})]}),a&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-800",children:a})}),C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsx("p",{className:"text-green-800",children:C})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:c,onChange:t=>m(t.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Search accounts..."})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:O?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):e.jsx("ul",{className:"divide-y divide-gray-200",children:z.map(t=>{var u,p;return e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-emerald-100 flex items-center justify-center",children:e.jsx(U,{className:"h-5 w-5 text-emerald-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.account_number}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-1"})," Member: ",((u=t.members)==null?void 0:u.full_name)||"N/A"]}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-1"})," Type: ",((p=t.account_types)==null?void 0:p.name)||"N/A"]}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(V,{className:"h-4 w-4 mr-1"})," Balance: ",t.balance.toLocaleString("en-US",{style:"currency",currency:"USD"})]}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"})," Open Date: ",new Date(t.open_date).toLocaleDateString()]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Status: ",e.jsx("span",{className:"font-medium capitalize",children:t.status})]}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:["Processing Fee Paid: ",t.processing_fee_paid?e.jsx(W,{className:"h-4 w-4 text-green-500 ml-1"}):e.jsx($,{className:"h-4 w-4 text-red-500 ml-1"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{s(t),n(!0)},className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(t.id),className:"inline-flex items-center p-2 border border-transparent rounded-full shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:e.jsx(J,{className:"h-4 w-4"})})]})]})},t.id)})})}),h&&e.jsx(ee,{members:q,accountTypes:M,bankAccounts:F,onClose:()=>i(!1),onSubmit:E}),r&&o&&e.jsx(se,{account:o,members:q,accountTypes:M,bankAccounts:F,onClose:()=>{n(!1),s(null)},onSubmit:P})]})}function ee({members:l,accountTypes:c,bankAccounts:m,onClose:h,onSubmit:i}){const[r,n]=d.useState({member_id:l.length>0?l[0].id:"",account_type_id:c.length>0?c[0].id:"",bank_account_id:m.length>0?m[0].id:"",account_number:"",balance:0,open_date:new Date().toISOString().split("T")[0],status:"open"}),o=s=>{s.preventDefault(),i(r)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Account"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Member"}),e.jsx("select",{required:!0,value:r.member_id,onChange:s=>n(a=>({...a,member_id:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:l.map(s=>e.jsx("option",{value:s.id,children:s.full_name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Type"}),e.jsx("select",{required:!0,value:r.account_type_id,onChange:s=>n(a=>({...a,account_type_id:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:c.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Number"}),e.jsx("input",{type:"text",required:!0,value:r.account_number,onChange:s=>n(a=>({...a,account_number:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Balance"}),e.jsx("input",{type:"number",step:"0.01",value:r.balance,onChange:s=>n(a=>({...a,balance:parseFloat(s.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Open Date"}),e.jsx("input",{type:"date",value:r.open_date,onChange:s=>n(a=>({...a,open_date:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:r.status,onChange:s=>n(a=>({...a,status:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md",children:"Create Account"})]})]})]})})})}function se({account:l,members:c,accountTypes:m,onClose:h,onSubmit:i}){const[r,n]=d.useState({member_id:l.member_id,account_type_id:l.account_type_id,account_number:l.account_number,balance:l.balance,open_date:l.open_date.split("T")[0],status:l.status,processing_fee_paid:l.processing_fee_paid}),o=s=>{s.preventDefault(),i(r)};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit Account"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Member"}),e.jsx("select",{required:!0,value:r.member_id,onChange:s=>n(a=>({...a,member_id:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:c.map(s=>e.jsx("option",{value:s.id,children:s.full_name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Type"}),e.jsx("select",{required:!0,value:r.account_type_id,onChange:s=>n(a=>({...a,account_type_id:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Account Number"}),e.jsx("input",{type:"text",required:!0,value:r.account_number,onChange:s=>n(a=>({...a,account_number:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Balance"}),e.jsx("input",{type:"number",step:"0.01",value:r.balance,onChange:s=>n(a=>({...a,balance:parseFloat(s.target.value)})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Open Date"}),e.jsx("input",{type:"date",value:r.open_date,onChange:s=>n(a=>({...a,open_date:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{value:r.status,onChange:s=>n(a=>({...a,status:s.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"processing_fee_paid",checked:r.processing_fee_paid,onChange:s=>n(a=>({...a,processing_fee_paid:s.target.checked})),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsx("label",{htmlFor:"processing_fee_paid",className:"ml-2 text-sm text-gray-700",children:"Processing Fee Paid"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md",children:"Update Account"})]})]})]})})})}export{ce as default};
